
{
    "kind": "term",
    "name": "ss_cloud-stream_data-sources",
    "count": 1,
    "items": [

    
        {
            "weight": "100",
            "url": "https://docs.tealium.com/server-side/functions/data-record-functions/data-record-functions/",
            "title": "About data record functions",
            "body": "<p class=\"note\"><i class=\"fa fa-exclamation-triangle\"></i>To enable CloudStream functions, go to <strong>Admin menu</strong> &gt; <strong>Server-Side Settings</strong> &gt; <strong>CloudStream Connectors</strong>, set <strong>Activate CloudStream Connectors</strong> to <code>On</code>, and click <strong>Save</strong>.</p>\n<h2 id=\"how-it-works\">How it works</h2>\n<p>Functions in CloudStream run within the CloudStream data pipeline and have access to the queried data records from your cloud data sources. Use functions within a CloudStream profile to retrieve data from other systems, augment your data, or send data to other endpoints.</p>\n<p>Adding and managing CloudStream functions is the same as managing other functions, with the following exceptions:</p>\n<ul>\n<li>When creating a function, instead of selecting an audience or an event, you select a <a href=\"/server-side/cloudstream/datasources/\">cloud data source</a> and a <a href=\"/server-side/cloudstream/segments/\">segment</a>.</li>\n<li>Each CloudStream function can only use data from one data source. If you want to activate data from additional data sources, configure a separate function for each one.</li>\n<li>If a segment contains attributes mapped from multiple data sources, only the attributes from the selected data source are available in the function.</li>\n</ul>\n<p>For more about functions, see <a href=\"/server-side/functions/about/\">About functions</a>.</p>\n<h2 id=\"triggers\">Triggers</h2>\n<p>CloudStream data record functions are triggered after the data record has been processed, as shown in the following CloudStream data pipeline diagram:</p>\n<figure><a class=\"slb\" href=\"/images/server-side/functions-data-record-pipeline.png\"><img src=\"https://docs.tealium.com/images/server-side/functions-data-record-pipeline.png\"/>\n    </a>\n</figure>\n<p>Use functions at this point in the pipeline as activations to send the data record to other systems.</p>\n<p class=\"note\"><i class=\"fa fa-exclamation-triangle\"></i>At this point in the CloudStream data pipeline, modifications to the <code>dataRecord</code> object have no effect on other parts of the system.</p>\n<h2 id=\"runtime-version\">Runtime version</h2>\n<p>The current runtime version is the same as <a href=\"/server-side/functions/event-visitor-functions/event-visitor-v3/\">event and visitor functions V3</a>, but includes the following changes:</p>\n<ul>\n<li>The <code>track</code> library has been removed.</li>\n<li>The data record cannot be sent back to Tealium as a new event.</li>\n</ul>\n<h2 id=\"activate-function\">activate() function</h2>\n<p>When you create a data record function, the default code is shown in the <strong>Code</strong> tab of the functions code editor:</p>\n<figure><a class=\"slb\" href=\"/images/early-access/cloudstream/cloudstream_function_details.png\"><img src=\"https://docs.tealium.com/images/early-access/cloudstream/cloudstream_function_details.png\"/>\n    </a>\n</figure>\n<p>This code contains the <code>activate()</code> function and its input parameters.</p>\n<div class=\"highlight\"><pre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"><code class=\"language-js\" data-lang=\"js\"><span style=\"display:flex;\"><span><span style=\"color:#a6e22e\">activate</span>(<span style=\"color:#66d9ef\">async</span> ({ <span style=\"color:#a6e22e\">dataRecord</span>, <span style=\"color:#a6e22e\">helper</span> }) =&gt; {\n</span></span><span style=\"display:flex;\"><span>  ...\n</span></span><span style=\"display:flex;\"><span>});\n</span></span></code></pre></div><p>Data record functions have a <a href=\"#data-record-object\"><code>dataRecord object</code></a> and <code>helper</code> object.</p>\n<p>The <code>helper</code> parameter provides <code>helper.getAuth()</code> and <code>helper.getGlobalVariable()</code> for getting authorization and retrieving global variables. For more information, see <a href=\"/server-side/functions/event-visitor-functions/event-visitor-v3/#helper-object\">Helper object</a>.</p>\n<h3 id=\"data-record-object\">Data record object</h3>\n<p>The <code>dataRecord</code> object is available for CloudStream functions and contains the following properties:</p>\n<table>\n<thead>\n<tr>\n<th>Property</th>\n<th>Data type</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>account</code></td>\n<td>string</td>\n<td>Tealium account name.</td>\n</tr>\n<tr>\n<td><code>data</code></td>\n<td>object</td>\n<td>The data record queried from the cloud data source, referenced at <code>dataRecord.data.udo</code>.</td>\n</tr>\n<tr>\n<td><code>event_id</code></td>\n<td>string</td>\n<td>Tealium event ID.</td>\n</tr>\n<tr>\n<td><code>post_time</code></td>\n<td>number</td>\n<td>Timestamp indicating when the data record was queried.</td>\n</tr>\n<tr>\n<td><code>profile</code></td>\n<td>string</td>\n<td>Tealium profile name.</td>\n</tr>\n<tr>\n<td><code>dataSourceId</code></td>\n<td>string</td>\n<td>The ID of the data source.</td>\n</tr>\n</tbody>\n</table>\n<p>Example data record object:</p>\n<div class=\"highlight\"><pre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"><code class=\"language-json\" data-lang=\"json\"><span style=\"display:flex;\"><span>{\n</span></span><span style=\"display:flex;\"><span>  <span style=\"color:#f92672\">&#34;account&#34;</span>: <span style=\"color:#e6db74\">&#34;your-account&#34;</span>,\n</span></span><span style=\"display:flex;\"><span>  <span style=\"color:#f92672\">&#34;profile&#34;</span>: <span style=\"color:#e6db74\">&#34;your-profile&#34;</span>,\n</span></span><span style=\"display:flex;\"><span>  <span style=\"color:#f92672\">&#34;data&#34;</span>: {\n</span></span><span style=\"display:flex;\"><span>    <span style=\"color:#f92672\">&#34;udo&#34;</span>: {\n</span></span><span style=\"display:flex;\"><span>      <span style=\"color:#f92672\">&#34;CDW_Column1_Timestamp&#34;</span>: <span style=\"color:#ae81ff\">1753077016157</span>,\n</span></span><span style=\"display:flex;\"><span>      <span style=\"color:#f92672\">&#34;CDW_Column2_Id&#34;</span>: <span style=\"color:#ae81ff\">10</span>,\n</span></span><span style=\"display:flex;\"><span>      <span style=\"color:#f92672\">&#34;CDW_Column3_EmailAddress&#34;</span>: <span style=\"color:#e6db74\">&#34;user@example.com&#34;</span>,\n</span></span><span style=\"display:flex;\"><span>      <span style=\"color:#f92672\">&#34;_dc_ttl_&#34;</span>: <span style=\"color:#ae81ff\">60000</span>,\n</span></span><span style=\"display:flex;\"><span>      <span style=\"color:#f92672\">&#34;tealium_datasource&#34;</span>: <span style=\"color:#e6db74\">&#34;abcdefg&#34;</span>,\n</span></span><span style=\"display:flex;\"><span>      <span style=\"color:#f92672\">&#34;tealium_event&#34;</span>: <span style=\"color:#e6db74\">&#34;data_ingestion&#34;</span>\n</span></span><span style=\"display:flex;\"><span>    }\n</span></span><span style=\"display:flex;\"><span>  },\n</span></span><span style=\"display:flex;\"><span>  <span style=\"color:#f92672\">&#34;dataSourceId&#34;</span>: <span style=\"color:#e6db74\">&#34;abcdefg&#34;</span>,\n</span></span><span style=\"display:flex;\"><span>  <span style=\"color:#f92672\">&#34;event_id&#34;</span>: <span style=\"color:#e6db74\">&#34;cf8bd406-787b-4fe9-8b45-7782e6663708&#34;</span>,\n</span></span><span style=\"display:flex;\"><span>  <span style=\"color:#f92672\">&#34;post_time&#34;</span>: <span style=\"color:#ae81ff\">1753774131897</span>,\n</span></span><span style=\"display:flex;\"><span>}\n</span></span></code></pre></div><h3 id=\"example\">Example</h3>\n<p>This is an example CloudStream function that uses the Tealium Crypto library to hash an email address attribute (<code>CDW_Column3_EmailAddress</code>) from the data record and then send the data record to a webhook.</p>\n<div class=\"highlight\"><pre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"><code class=\"language-javascript\" data-lang=\"javascript\"><span style=\"display:flex;\"><span><span style=\"color:#66d9ef\">import</span> <span style=\"color:#a6e22e\">C</span> <span style=\"color:#a6e22e\">from</span> <span style=\"color:#e6db74\">&#34;tealium/crypto&#34;</span>;\n</span></span><span style=\"display:flex;\"><span>\n</span></span><span style=\"display:flex;\"><span><span style=\"color:#66d9ef\">const</span> <span style=\"color:#a6e22e\">send</span> <span style=\"color:#f92672\">=</span> <span style=\"color:#66d9ef\">async</span> (<span style=\"color:#a6e22e\">data</span>) =&gt; {\n</span></span><span style=\"display:flex;\"><span>        <span style=\"color:#a6e22e\">console</span>.<span style=\"color:#a6e22e\">log</span>(<span style=\"color:#e6db74\">&#34;Sending: &#34;</span> <span style=\"color:#f92672\">+</span> <span style=\"color:#a6e22e\">JSON</span>.<span style=\"color:#a6e22e\">stringify</span>(<span style=\"color:#a6e22e\">data</span>, <span style=\"color:#66d9ef\">null</span>, <span style=\"color:#ae81ff\">2</span>));\n</span></span><span style=\"display:flex;\"><span>\n</span></span><span style=\"display:flex;\"><span>        <span style=\"color:#66d9ef\">return</span> <span style=\"color:#a6e22e\">fetch</span>(<span style=\"color:#e6db74\">&#34;https://example.com/example-webhook/&#34;</span>, {\n</span></span><span style=\"display:flex;\"><span>        <span style=\"color:#a6e22e\">method</span><span style=\"color:#f92672\">:</span> <span style=\"color:#e6db74\">&#39;POST&#39;</span>,\n</span></span><span style=\"display:flex;\"><span>        <span style=\"color:#a6e22e\">headers</span><span style=\"color:#f92672\">:</span> {\n</span></span><span style=\"display:flex;\"><span>            <span style=\"color:#e6db74\">&#39;Accept&#39;</span><span style=\"color:#f92672\">:</span> <span style=\"color:#e6db74\">&#39;application/json&#39;</span>,\n</span></span><span style=\"display:flex;\"><span>            <span style=\"color:#e6db74\">&#39;Content-Type&#39;</span><span style=\"color:#f92672\">:</span> <span style=\"color:#e6db74\">&#39;application/json&#39;</span>\n</span></span><span style=\"display:flex;\"><span>        },\n</span></span><span style=\"display:flex;\"><span>        <span style=\"color:#a6e22e\">body</span><span style=\"color:#f92672\">:</span> <span style=\"color:#a6e22e\">JSON</span>.<span style=\"color:#a6e22e\">stringify</span>(<span style=\"color:#a6e22e\">data</span>)\n</span></span><span style=\"display:flex;\"><span>});\n</span></span><span style=\"display:flex;\"><span>}\n</span></span><span style=\"display:flex;\"><span>\n</span></span><span style=\"display:flex;\"><span><span style=\"color:#a6e22e\">activate</span>(<span style=\"color:#66d9ef\">async</span> ({ <span style=\"color:#a6e22e\">dataRecord</span> }) =&gt; {\n</span></span><span style=\"display:flex;\"><span>    <span style=\"color:#66d9ef\">const</span> <span style=\"color:#a6e22e\">data</span> <span style=\"color:#f92672\">=</span> { ...<span style=\"color:#a6e22e\">dataRecord</span>.<span style=\"color:#a6e22e\">data</span>.<span style=\"color:#a6e22e\">udo</span>  };\n</span></span><span style=\"display:flex;\"><span>\n</span></span><span style=\"display:flex;\"><span>    <span style=\"color:#a6e22e\">data</span>.<span style=\"color:#a6e22e\">tc_email</span> <span style=\"color:#f92672\">=</span> <span style=\"color:#a6e22e\">C</span>.<span style=\"color:#a6e22e\">SHA3</span>(<span style=\"color:#a6e22e\">dataRecord</span>.<span style=\"color:#a6e22e\">data</span>.<span style=\"color:#a6e22e\">udo</span>.<span style=\"color:#a6e22e\">CDW_Column3_EmailAddress</span>).<span style=\"color:#a6e22e\">toString</span>(<span style=\"color:#a6e22e\">C</span>.<span style=\"color:#a6e22e\">enc</span>.<span style=\"color:#a6e22e\">Hex</span>);\n</span></span><span style=\"display:flex;\"><span>\n</span></span><span style=\"display:flex;\"><span><span style=\"color:#66d9ef\">try</span> {\n</span></span><span style=\"display:flex;\"><span>    <span style=\"color:#66d9ef\">await</span> <span style=\"color:#a6e22e\">send</span>(<span style=\"color:#a6e22e\">data</span>);\n</span></span><span style=\"display:flex;\"><span>    } <span style=\"color:#66d9ef\">catch</span> (<span style=\"color:#a6e22e\">e</span>) {\n</span></span><span style=\"display:flex;\"><span>        <span style=\"color:#a6e22e\">console</span>.<span style=\"color:#a6e22e\">error</span>(<span style=\"color:#e6db74\">&#34;Failed to send the data. &#34;</span> <span style=\"color:#f92672\">+</span> <span style=\"color:#a6e22e\">e</span>);\n</span></span><span style=\"display:flex;\"><span>    }\n</span></span><span style=\"display:flex;\"><span>});\n</span></span></code></pre></div>"
        }  

    ]
}
